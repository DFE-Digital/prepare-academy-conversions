@page "/project-list"
@model ApplyToBecomeInternal.Pages.ProjectList.IndexModel
@{
    ViewData["Title"] = "Project list";
}

@functions {
    bool ShowHtbDate(ProjectListViewModel vm) => !string.IsNullOrWhiteSpace(vm.HeadTeacherBoardDate);
}
<h1 class="govuk-heading-xl">Manage an academy conversion</h1>
<h2 class="govuk-heading-l">Projects (@Model.ProjectCount)</h2>

<table class="govuk-table">    
    <thead class="govuk-table__head">
        <tr class="govuk-table__row">
            <th scope="col" class="govuk-table__header">Application information</th>
            <th scope="col" class="govuk-table__header">Project status and dates</th>
        </tr>
    </thead>
    <tbody class="govuk-table__body">      

        @{
            var index = 0;
            foreach (var project in Model.Projects)
            {
                <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header">
                        <h2 class="govuk-caption-l govuk-!-margin-bottom-0 govuk-!-margin-top-1">
                            <strong>
                                <a id="@("school-name-" + index)" class="govuk-link" asp-page="@Links.TaskList.Index.Page" asp-route-id="@project.Id">@project.SchoolName</a>
                            </strong> <span id="@("urn-" + index)">URN @project.SchoolURN</span>
                        </h2>
                        <p class="govuk-body govuk-!-margin-top-2 govuk--!-margin-bottom-0">
                            <span id="@("application-to-join-trust-" + index)">Application to join a trust: @project.NameOfTrust<br></span>
                            <span id="@("local-authority-" + index)">Local authority: @project.LocalAuthority</span>
                        </p>
                    </th>
                    <td class="govuk-table__cell">
                        <p class="govuk-tag govuk-tag--yellow govuk-!-margin-top-0  govuk-!-margin-bottom-3">PRE ADVISORY BOARD</p>
                        <p class="govuk-hint govuk-!-margin-top-0">
                            <span id="@("application-received-date-" + index)">
                                @("Application received: " + project.ApplicationReceivedDate)<br>
                            </span>
                            @if (ShowHtbDate(project))
                            {
                                <span id="@("Advisory-Board-date-" + index)">
                                    @("Advisory board date: " + project.HeadTeacherBoardDate)<br>
                                </span>
                                <span id="@("opening-date-" + index)">@("Opening date: " + project.ProposedAcademyOpeningDate)</span>
                            }
                        </p>
                    </td>
                </tr>                
                index++;
            }
        }        

    </tbody>
</table>